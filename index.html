<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IT Department Checklist Form - New Staff</title>
    <!-- Tailwind CSS & DaisyUI -->
    <link href="https://cdn.jsdelivr.net/npm/daisyui@4.4.19/dist/full.min.css" rel="stylesheet" type="text/css" />
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- jsPDF and AutoTable for direct download -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>
    <style>
        body {
            font-family: Arial, Helvetica, sans-serif;
            background-color: #f0f2f5;
        }

        #pdf-content {
            width: 210mm;
            min-height: 297mm;
            padding: 15mm 20mm;
            margin: auto;
            background: white;
            box-shadow: 0 0 20px rgba(0,0,0,0.15);
            color: black;
            font-size: 11pt;
            line-height: 1.4;
            position: relative;
        }

        .form-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 1.2rem;
        }

        .form-table th, .form-table td {
            border: 1px solid #000;
            padding: 6px 10px;
            text-align: left;
            vertical-align: middle;
        }

        .header-title {
            color: #003366; 
            font-weight: 900;
            font-size: 16pt;
            border-bottom: 2px solid #003366;
            display: inline-block;
            margin-bottom: 20px;
            text-transform: uppercase;
        }

        .section-label {
            color: #003366;
            font-weight: bold;
            text-decoration: underline;
            margin-bottom: 8px;
            display: block;
        }

        .it-only-label {
            color: #cc0000; 
            font-weight: bold;
            font-style: italic;
            font-size: 9pt;
            margin-bottom: 4px;
        }

        .check-box-square {
            display: inline-block;
            width: 16px;
            height: 16px;
            border: 1px solid black;
            text-align: center;
            line-height: 14px;
            font-weight: bold;
            margin-right: 10px;
            background: #fff;
        }

        .underline-field {
            border-bottom: 1px solid black;
            padding-bottom: 1px;
            font-weight: bold;
        }

        @media print {
            .no-print { display: none !important; }
            #pdf-content { box-shadow: none; margin: 0; padding: 15mm 20mm; }
        }
    </style>
</head>
<body class="min-h-screen">

    <div class="flex flex-col lg:flex-row h-screen overflow-hidden">
        
        <!-- Sidebar Form Input (Left) -->
        <div class="w-full lg:w-96 bg-base-100 p-6 overflow-y-auto border-r border-base-300 no-print flex-shrink-0">
            <div class="flex flex-col gap-4 mb-8">
                <h1 class="text-xl font-black text-slate-800 uppercase tracking-tight">IT Form Editor</h1>
                <div class="grid grid-cols-1 gap-2">
                    <button onclick="downloadDirectPDF()" class="btn btn-primary w-full shadow-lg">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" /></svg>
                        Download PDF
                    </button>
                    <button onclick="window.print()" class="btn btn-outline btn-sm">
                        Print / Save via Browser
                    </button>
                </div>
            </div>

            <!-- Editor Accordions -->
            <div class="join join-vertical w-full">
                <!-- Employee -->
                <div class="collapse collapse-arrow join-item border border-base-300 bg-base-100">
                    <input type="radio" name="editor-panels" checked="checked" /> 
                    <div class="collapse-title font-bold text-sm uppercase">Employee Details</div>
                    <div class="collapse-content space-y-3 pt-4">
                        <div class="form-control">
                            <label class="label p-1"><span class="label-text text-xs">Company Name</span></label>
                            <select id="in-company" class="select select-sm select-bordered w-full" onchange="sync()">
                                <optgroup label="TMS+">
                                    <option value="Total Metering Solution Sdn Bhd">Total Metering Solution Sdn Bhd</option>
                                    <option value="TMS Enthu Technology Sdn Bhd">TMS Enthu Technology Sdn Bhd</option>
                                    <option value="TMS Energy Sdn Bhd">TMS Energy Sdn Bhd</option>
                                    <option value="TMS KJ Distribution Sdn Bhd">TMS KJ Distribution Sdn Bhd</option>
                                </optgroup>
                                <optgroup label="PVG">
                                    <option value="Broyson Automation Sdn Bhd">Broyson Automation Sdn Bhd</option>
                                    <option value="Well Prestige Sdn Bhd">Well Prestige Sdn Bhd</option>
                                    <option value="Synergy Instrumentation Sdn Bhd">Synergy Instrumentation Sdn Bhd</option>
                                    <option value="Green Protechnic Sdn Bhd">Green Protechnic Sdn Bhd</option>
                                    <option value="Jamac Metering Sdn Bhd" selected>Jamac Metering Sdn Bhd</option>
                                </optgroup>
                                <optgroup label="Others">
                                    <option value="SFG Technology (M) Sdn Bhd">SFG Technology (M) Sdn Bhd</option>
                                    <option value="Omnipro Industries Sdn Bhd">Omnipro Industries Sdn Bhd</option>
                                </optgroup>
                            </select>
                        </div>
                        <div class="form-control">
                            <label class="label p-1"><span class="label-text text-xs">Staff Name</span></label>
                            <input type="text" id="in-name" class="input input-sm input-bordered w-full" value="Mohd Khirul Anuar Bin Saadon" oninput="sync()">
                        </div>
                        <div class="form-control">
                            <label class="label p-1"><span class="label-text text-xs">Staff ID</span></label>
                            <input type="text" id="in-id" class="input input-sm input-bordered w-full" value="JM083" oninput="sync()">
                        </div>
                        <div class="form-control">
                            <label class="label p-1"><span class="label-text text-xs">Department</span></label>
                            <input type="text" id="in-dept" class="input input-sm input-bordered w-full" value="Laboratory" oninput="sync()">
                        </div>
                        <div class="form-control">
                            <label class="label p-1"><span class="label-text text-xs">Designation</span></label>
                            <input type="text" id="in-desig" class="input input-sm input-bordered w-full" value="Lab Engineer" oninput="sync()">
                        </div>
                    </div>
                </div>

                <!-- Procedures -->
                <div class="collapse collapse-arrow join-item border border-base-300 bg-base-100">
                    <input type="radio" name="editor-panels" /> 
                    <div class="collapse-title font-bold text-sm uppercase">IT Procedures</div>
                    <div class="collapse-content space-y-1 pt-4">
                        <label class="label cursor-pointer py-1">
                            <span class="label-text text-xs">Hand Over Hardware</span>
                            <input type="checkbox" id="chk-handover" class="checkbox checkbox-xs" onchange="sync()">
                        </label>
                        <label class="label cursor-pointer py-1">
                            <span class="label-text text-xs">Account Settings</span>
                            <input type="checkbox" id="chk-account" class="checkbox checkbox-xs" checked onchange="sync()">
                        </label>
                        <label class="label cursor-pointer py-1">
                            <span class="label-text text-xs">New Profile Setup</span>
                            <input type="checkbox" id="chk-profile" class="checkbox checkbox-xs" checked onchange="sync()">
                        </label>
                        <label class="label cursor-pointer py-1">
                            <span class="label-text text-xs">Email Setup</span>
                            <input type="checkbox" id="chk-email" class="checkbox checkbox-xs" checked onchange="sync()">
                        </label>
                        <label class="label cursor-pointer py-1">
                            <span class="label-text text-xs">Printer Drivers</span>
                            <input type="checkbox" id="chk-printer" class="checkbox checkbox-xs" checked onchange="sync()">
                        </label>
                    </div>
                </div>

                <!-- Software -->
                <div class="collapse collapse-arrow join-item border border-base-300 bg-base-100">
                    <input type="radio" name="editor-panels" /> 
                    <div class="collapse-title font-bold text-sm uppercase">Software</div>
                    <div class="collapse-content space-y-1 pt-4">
                        <label class="label cursor-pointer py-1"><span class="label-text text-xs">AnyDesk</span><input type="checkbox" id="sw-anydesk" class="checkbox checkbox-xs checkbox-primary" onchange="sync()"></label>
                        <label class="label cursor-pointer py-1"><span class="label-text text-xs">MS Office 365</span><input type="checkbox" id="sw-office" class="checkbox checkbox-xs checkbox-primary" checked onchange="sync()"></label>
                        <label class="label cursor-pointer py-1"><span class="label-text text-xs">Adobe PDF</span><input type="checkbox" id="sw-pdf" class="checkbox checkbox-xs checkbox-primary" onchange="sync()"></label>
                        <label class="label cursor-pointer py-1"><span class="label-text text-xs">VPN</span><input type="checkbox" id="sw-vpn" class="checkbox checkbox-xs checkbox-primary" onchange="sync()"></label>
                        <label class="label cursor-pointer py-1"><span class="label-text text-xs">Chrome</span><input type="checkbox" id="sw-chrome" class="checkbox checkbox-xs checkbox-primary" onchange="sync()"></label>
                        <label class="label cursor-pointer py-1"><span class="label-text text-xs">RDP</span><input type="checkbox" id="sw-rdp" class="checkbox checkbox-xs checkbox-primary" onchange="sync()"></label>
                        <label class="label cursor-pointer py-1"><span class="label-text text-xs">Ticket Sys.</span><input type="checkbox" id="sw-ticket" class="checkbox checkbox-xs checkbox-primary" onchange="sync()"></label>
                    </div>
                </div>

                <!-- Final -->
                <div class="collapse collapse-arrow join-item border border-base-300 bg-base-100">
                    <input type="radio" name="editor-panels" /> 
                    <div class="collapse-title font-bold text-sm uppercase">Asset & Date</div>
                    <div class="collapse-content space-y-3 pt-4">
                        <div class="form-control">
                            <label class="label p-1"><span class="label-text text-xs">Asset No.</span></label>
                            <input type="text" id="in-asset" class="input input-sm input-bordered w-full" value="NO RECORD" oninput="sync()">
                        </div>
                        <div class="form-control">
                            <label class="label p-1"><span class="label-text text-xs">Handover Date</span></label>
                            <input type="date" id="in-date" class="input input-sm input-bordered w-full" oninput="sync()">
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Live Preview (Right) -->
        <div class="flex-grow p-8 bg-slate-300 overflow-y-auto flex justify-center">
            <div id="pdf-content">
                <!-- PDF Header -->
                <div class="text-center mb-10">
                    <div class="header-title">IT DEPARTMENT CHECK LIST (NEW STAFF)</div>
                </div>

                <!-- Section: Employee Details -->
                <div class="mb-6">
                    <span class="section-label">EMPLOYEE DETAILS:</span>
                    <table class="form-table">
                        <tr>
                            <td width="35%" class="bg-slate-50 font-bold text-[9pt]">COMPANY NAME:</td>
                            <td id="pv-company" class="font-bold text-[10pt]"></td>
                        </tr>
                        <tr>
                            <td class="bg-slate-50 font-bold text-[9pt]">STAFF NAME:</td>
                            <td id="pv-name" class="font-bold text-[10pt]"></td>
                        </tr>
                        <tr>
                            <td class="bg-slate-50 font-bold text-[9pt]">STAFF ID:</td>
                            <td id="pv-id" class="font-bold text-[10pt]"></td>
                        </tr>
                        <tr>
                            <td class="bg-slate-50 font-bold text-[9pt]">DEPARTMENT:</td>
                            <td id="pv-dept" class="font-bold text-[10pt]"></td>
                        </tr>
                        <tr>
                            <td class="bg-slate-50 font-bold text-[9pt]">DESIGNATION:</td>
                            <td id="pv-desig" class="font-bold text-[10pt]"></td>
                        </tr>
                    </table>
                </div>

                <!-- Section: Procedure -->
                <div class="mb-6">
                    <p class="it-only-label">**IT USE ONLY***</p>
                    <span class="section-label">NEW STAFF PROCEDURE:</span>
                    <table class="form-table">
                        <tr>
                            <td width="80%" class="text-[9pt] font-bold">HAND OVER (LAPTOP / DESKTOP)</td>
                            <td width="20%" class="text-center font-bold text-xl" id="pv-chk-handover"></td>
                        </tr>
                        <tr>
                            <td class="text-[9pt] font-bold">CHANGE ACCOUNT SETTING</td>
                            <td class="text-center font-bold text-xl" id="pv-chk-account"></td>
                        </tr>
                        <tr>
                            <td class="text-[9pt] font-bold">SETUP NEW PROFILE UNDER USERNAME</td>
                            <td class="text-center font-bold text-xl" id="pv-chk-profile"></td>
                        </tr>
                        <tr>
                            <td class="text-[9pt] font-bold">SETUP EMAIL ADDRESS</td>
                            <td class="text-center font-bold text-xl" id="pv-chk-email"></td>
                        </tr>
                        <tr>
                            <td class="text-[9pt] font-bold">INSTALL THE NECESSARY PRINTER DRIVER</td>
                            <td class="text-center font-bold text-xl" id="pv-chk-printer"></td>
                        </tr>
                    </table>
                </div>

                <!-- Section: Software -->
                <div class="mb-8">
                    <span class="section-label">SOFTWARE (NEED TO BE INSTALLED):</span>
                    <table class="form-table">
                        <tr>
                            <td width="80%" class="text-[9pt] font-bold">ANYDESK (REMOTE USE)</td>
                            <td width="20%" class="text-center font-bold text-xl" id="pv-sw-anydesk"></td>
                        </tr>
                        <tr>
                            <td class="text-[9pt] font-bold">MICROSOFT OFFICE 365</td>
                            <td class="text-center font-bold text-xl" id="pv-sw-office"></td>
                        </tr>
                        <tr>
                            <td class="text-[9pt] font-bold">ADOBE PDF</td>
                            <td class="text-center font-bold text-xl" id="pv-sw-pdf"></td>
                        </tr>
                        <tr>
                            <td class="text-[9pt] font-bold">VPN (WORK FROM HOME)</td>
                            <td class="text-center font-bold text-xl" id="pv-sw-vpn"></td>
                        </tr>
                        <tr>
                            <td class="text-[9pt] font-bold">GOOGLE CHROME (BROWSER)</td>
                            <td class="text-center font-bold text-xl" id="pv-sw-chrome"></td>
                        </tr>
                        <tr>
                            <td class="text-[9pt] font-bold">REMOTE DESKTOP (GP USER)</td>
                            <td class="text-center font-bold text-xl" id="pv-sw-rdp"></td>
                        </tr>
                        <tr>
                            <td class="text-[9pt] font-bold">IT TICKETING SYSTEM REGISTRATION</td>
                            <td class="text-center font-bold text-xl" id="pv-sw-ticket"></td>
                        </tr>
                    </table>
                </div>

                <!-- Section: Assets -->
                <div class="mb-10">
                    <p class="it-only-label">**IT USE ONLY***</p>
                    <div class="space-y-4">
                        <p class="font-bold">FIX ASSET NUMBER: <span id="pv-asset" class="underline-field ml-2 px-4 min-w-[150px] inline-block"></span></p>
                        <p class="font-bold">DATE HANDOVER: <span id="pv-date" class="underline-field ml-2 px-4 min-w-[150px] inline-block"></span></p>
                    </div>
                </div>

                <!-- Footer Stats -->
                <div class="absolute bottom-8 left-20 right-20 pt-2 border-t border-black flex justify-between text-[8pt] font-bold text-slate-700">
                    <div>HQ-IT-F01 Rev.: 00</div>
                    <div>Page: 1 of 1</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Set Default Date
        document.getElementById('in-date').value = new Date().toISOString().split('T')[0];

        function sync() {
            const fields = ['company', 'name', 'id', 'dept', 'desig', 'asset'];
            fields.forEach(f => {
                const inputEl = document.getElementById(`in-${f}`);
                const previewEl = document.getElementById(`pv-${f}`);
                if (inputEl && previewEl) previewEl.innerText = inputEl.value || "";
            });
            
            const dateVal = document.getElementById('in-date').value;
            const datePv = document.getElementById('pv-date');
            if(dateVal && datePv) {
                const [y, m, d] = dateVal.split('-');
                datePv.innerText = `${d}/${m}/${y}`;
            }

            const procedures = ['handover', 'account', 'profile', 'email', 'printer'];
            procedures.forEach(id => {
                const chk = document.getElementById(`chk-${id}`);
                const pv = document.getElementById(`pv-chk-${id}`);
                if (chk && pv) pv.innerText = chk.checked ? '✓' : '';
            });

            const softwares = ['anydesk', 'office', 'pdf', 'vpn', 'chrome', 'rdp', 'ticket'];
            softwares.forEach(id => {
                const chk = document.getElementById(`sw-${id}`);
                const pv = document.getElementById(`pv-sw-${id}`);
                if (chk && pv) pv.innerText = chk.checked ? '✓' : '';
            });
        }

        async function downloadDirectPDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF('p', 'mm', 'a4');
            const staffName = document.getElementById('in-name').value || 'Staff';
            
            // Helper for Tick Symbol (ZapfDingbats ensures correct rendering)
            const getTick = (checked) => {
                return checked ? '4' : ''; // '4' in ZapfDingbats is a checkmark
            };

            // 1. Header
            doc.setTextColor(0, 51, 102); // #003366
            doc.setFont('helvetica', 'bold');
            doc.setFontSize(16);
            doc.text('IT DEPARTMENT CHECK LIST (NEW STAFF)', 105, 20, { align: 'center' });
            doc.setDrawColor(0, 51, 102);
            doc.setLineWidth(0.5);
            doc.line(40, 22, 170, 22);

            // 2. Employee Details Section
            doc.setFontSize(11);
            doc.text('EMPLOYEE DETAILS:', 20, 35);
            
            const empRows = [
                ['COMPANY NAME:', document.getElementById('in-company').value.toUpperCase()],
                ['STAFF NAME:', document.getElementById('in-name').value.toUpperCase()],
                ['STAFF ID:', document.getElementById('in-id').value.toUpperCase()],
                ['DEPARTMENT:', document.getElementById('in-dept').value.toUpperCase()],
                ['DESIGNATION:', document.getElementById('in-desig').value.toUpperCase()]
            ];

            doc.autoTable({
                startY: 38,
                margin: { left: 20, right: 20 },
                body: empRows,
                theme: 'grid',
                styles: { fontSize: 9, cellPadding: 2, textColor: 0, lineColor: 0, lineWidth: 0.1 },
                columnStyles: { 0: { cellWidth: 50, fontStyle: 'bold', fillColor: [245, 245, 245] } }
            });

            // 3. New Staff Procedure Section
            let currentY = doc.lastAutoTable.finalY + 10;
            doc.setTextColor(204, 0, 0); // Red
            doc.setFontSize(9);
            doc.text('**IT USE ONLY***', 20, currentY);
            
            doc.setTextColor(0, 51, 102);
            doc.setFontSize(11);
            doc.text('NEW STAFF PROCEDURE:', 20, currentY + 5);

            const procRows = [
                ['HAND OVER (LAPTOP / DESKTOP)', getTick(document.getElementById('chk-handover').checked)],
                ['CHANGE ACCOUNT SETTING', getTick(document.getElementById('chk-account').checked)],
                ['SETUP NEW PROFILE UNDER USERNAME', getTick(document.getElementById('chk-profile').checked)],
                ['SETUP EMAIL ADDRESS', getTick(document.getElementById('chk-email').checked)],
                ['INSTALL THE NECESSARY PRINTER DRIVER', getTick(document.getElementById('chk-printer').checked)]
            ];

            doc.autoTable({
                startY: currentY + 8,
                margin: { left: 20, right: 20 },
                body: procRows,
                theme: 'grid',
                styles: { fontSize: 9, cellPadding: 3, textColor: 0, lineColor: 0, lineWidth: 0.1 },
                columnStyles: { 
                    0: { fontStyle: 'bold' },
                    1: { halign: 'center', font: 'ZapfDingbats', fontSize: 14 } 
                }
            });

            // 4. Software Section (Converted to Table format)
            currentY = doc.lastAutoTable.finalY + 10;
            doc.setTextColor(0, 51, 102);
            doc.setFontSize(11);
            doc.text('SOFTWARE (NEED TO BE INSTALLED):', 20, currentY);

            const swRows = [
                ['ANYDESK (REMOTE USE)', getTick(document.getElementById('sw-anydesk').checked)],
                ['MICROSOFT OFFICE 365', getTick(document.getElementById('sw-office').checked)],
                ['ADOBE PDF', getTick(document.getElementById('sw-pdf').checked)],
                ['VPN (WORK FROM HOME)', getTick(document.getElementById('sw-vpn').checked)],
                ['GOOGLE CHROME (BROWSER)', getTick(document.getElementById('sw-chrome').checked)],
                ['REMOTE DESKTOP (GP USER)', getTick(document.getElementById('sw-rdp').checked)],
                ['IT TICKETING SYSTEM REGISTRATION', getTick(document.getElementById('sw-ticket').checked)]
            ];

            doc.autoTable({
                startY: currentY + 4,
                margin: { left: 20, right: 20 },
                body: swRows,
                theme: 'grid',
                styles: { fontSize: 9, cellPadding: 3, textColor: 0, lineColor: 0, lineWidth: 0.1 },
                columnStyles: { 
                    0: { fontStyle: 'bold' },
                    1: { halign: 'center', font: 'ZapfDingbats', fontSize: 14 } 
                }
            });

            // 5. Assets Section
            currentY = doc.lastAutoTable.finalY + 12;
            doc.setTextColor(204, 0, 0);
            doc.setFontSize(9);
            doc.text('**IT USE ONLY***', 20, currentY);
            
            doc.setTextColor(0);
            doc.setFont('helvetica', 'bold');
            doc.setFontSize(10);
            doc.text(`FIX ASSET NUMBER: ${document.getElementById('in-asset').value.toUpperCase()}`, 20, currentY + 8);
            
            const dateInput = document.getElementById('in-date').value;
            const dateStr = dateInput ? dateInput.split('-').reverse().join('/') : '';
            doc.text(`DATE HANDOVER: ${dateStr}`, 20, currentY + 16);

            // Footer
            doc.setFontSize(8);
            doc.setTextColor(100);
            doc.setFont('helvetica', 'normal');
            doc.text('HQ-IT-F01 Rev.: 00', 20, 285);
            doc.text('Page: 1 of 1', 170, 285);

            // Direct Save
            doc.save(`${staffName} (IT Department Checklist Form - New Staff).pdf`);
        }

        window.onload = sync;
    </script>
</body>
</html>
